import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

#Letura dei dati
file_path = "catalog.csv"
df = pd.read_csv(file_path)

#Selezino le colonne
z = df["BEST_Z"]
logM = df["logM500"]
offset = df["BCG_offset_R500"]

# Analisi statistica base delle distribuzioni
print("Statistiche di BCG_offset_R500:")
print(offset.describe())

print("Statistiche di LogM500:")
print(logM.describe())

print("Statistiche di BEST_Z:")
print(z.describe())

# visualizzo la distribuzione dell'offset
plt.figure(figsize=(4,3))
sns.histplot(offset, bins=40, kde=True, color="steelblue")
plt.xlabel("BCG_offset_R500")
plt.title("Distribuzione della distanza normalizzata")
plt.grid(alpha=0.3)
plt.show()

# Plot dell'Offset in funzione della massa
plt.figure(figsize=(4,3))
sns.scatterplot(x=logM, y=offset, s=20, alpha=0.7)
plt.xlabel("LogM500")
plt.ylabel("BCG_offset_R500")
plt.title("Offset normalizzato in funzione della massa")
plt.grid(alpha=0.3)
plt.show()

# Plot dell'Offset in funzione del redshift
plt.figure(figsize=(4,3))
sns.scatterplot(x=z, y=offset, s=20, alpha=0.7, color="darkred")
plt.xlabel("BEST_Z")
plt.ylabel("BCG_offset_R500")
plt.title("Offset normalizzato in funzione del redshift")
plt.grid(alpha=0.3)
plt.show()

plt.figure(figsize=(4,3))

sc = plt.scatter(
    logM, z,
    c=offset,
    cmap="turbo",
    s=25,
    alpha=0.4
)

plt.xlabel("LogM500")
plt.ylabel("BEST_Z")
plt.title("Mappa colore: BCG_offset_R500 in funzione di massa e redshift")
cbar = plt.colorbar(sc)
cbar.set_label("BCG_offset_R500")

plt.grid(alpha=0.3)
plt.show()
fig = plt.figure(figsize=(6,4))
ax = fig.add_subplot(111, projection='3d')

# scatter 3D con colore dato dall'offset
sc = ax.scatter(
    logM, 
    z, 
    offset, 
    c=offset,       
    cmap='turbo', 
    s=25,
    alpha=0.8
)

ax.set_xlabel("LogM500")
ax.set_ylabel("BEST_Z")
ax.set_zlabel("BCG_offset_R500")
ax.set_title("Offset normalizzato in funzione di massa e redshift")

cbar = fig.colorbar(sc, ax=ax, pad=0.1)
cbar.set_label("BCG_offset_R500")

plt.show()
